<?xml version="1.0" encoding="UTF-8"?> 
<!DOCTYPE mapper 
   PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
   "http://mybatis.org/dtd/mybatis-3-mapper.dtd"> 
   
<mapper namespace="com.innilabs.board.mapper.PostMapper"> 
    <!-- <select id="selectPosts" resultType="com.innilabs.board.dto.Post">
         SELECT 
            *
         FROM 
            POST
    </select>  -->
   <select id="selectPagedPosts" parameterType="Integer" resultType="com.innilabs.board.dto.Post">
      SELECT 
            post_id, title, writer, contents, created_at
      FROM
            POST
      WHERE
            is_deleted = 0
      ORDER BY 
            created_at DESC
      LIMIT
            #{startIndex}, #{size}

   </select>
 
   <select id="selectPostByPostId" parameterType="Integer" resultType="com.innilabs.board.dto.Post">
      SELECT 
            post_id, title, writer, contents, created_at
      FROM
            POST
      WHERE
            is_deleted = 0 
      And
            post_id = #{postId}

   </select>

   <update id="updatePostByPost" parameterType="com.innilabs.board.dto.Post">
      UPDATE 
            POST
      SET
            contents = #{contents},
            updated_at = now()
      WHERE
            is_deleted = 0 
      And
            post_id = #{postId}

   </update>

   <update id="deletePostByPostId" parameterType="Integer">
      UPDATE
            POST
      SET
            is_deleted = 1
      WHERE
            post_id = #{postId} 
   </update>
   
   <insert id="insertPostByPost" parameterType="com.innilabs.board.dto.Post">
      INSERT INTO 
            POST (title, contents, created_at, writer) 
      VALUES 
            (#{title}, #{contents}, now(), #{writer})     

   </insert>
</mapper>
